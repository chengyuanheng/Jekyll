<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>what do rake spec do</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="The quick brown fox jumps over a lazy dog">
    <link rel="canonical" href="http://chengyuanheng.github.io/Jekyll/Jekyll/jekyll/update/2014/11/21/what_do_rake_spec_do/">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/Jekyll/css/main.css">
    <link rel="stylesheet" href="/Jekyll/css/pygments.css">
</head>


    <body>

      <div class="container">

        <div class="header">
    <h1>
        <a style="color: #000;" href="/Jekyll/">Uncopyrighted</a>
    </h1>
    <p class="sub">
        The quick brown fox jumps over a lazy dog
    </p>

    <div class="menu">
        <ul class="navlist">
            
            <li>
                <a class="page-link" href="/Jekyll/about">about</a>
            </li>
            
            <li>
                <a class="page-link" href="/Jekyllhttp://twitter.com/alixedi">twt</a>
            </li>
            
            <li>
                <a class="page-link" href="/Jekyllhttp://github.com/chengyuanheng">github</a>
            </li>
            
            <li>
                <a class="page-link" href="/Jekyll/feed.xml">rss</a>
            </li>
            
        </ul>
    </div>
</div>




        <div class="post">

  <header class="post-header">
    <h1>what do rake spec do</h1>
  </header>

  <p class="meta">Nov 21, 2014</p>

  <article class="post-content">
  <h3 id="specrubydslruby-on-railsspec">spec是ruby的dsl,为ruby on rails框架提供单元测试功能,但是spec在运行过程中都做了哪些事情呢?下面我们来一起看一下:</h3>

<p>when run rake spec –trace, you can see something like this:</p>

<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="o">**</span> <span class="no">Invoke</span> <span class="n">spec</span> <span class="p">(</span><span class="n">first_time</span><span class="p">)</span>
<span class="o">**</span> <span class="no">Invoke</span> <span class="ss">db</span><span class="p">:</span><span class="nb">test</span><span class="ss">:prepare</span> <span class="p">(</span><span class="n">first_time</span><span class="p">)</span>
<span class="o">**</span> <span class="no">Invoke</span> <span class="ss">db</span><span class="p">:</span><span class="n">abort_if_pending_migrations</span> <span class="p">(</span><span class="n">first_time</span><span class="p">)</span>
<span class="o">**</span> <span class="no">Invoke</span> <span class="n">environment</span> <span class="p">(</span><span class="n">first_time</span><span class="p">)</span>
<span class="o">**</span> <span class="no">Execute</span> <span class="n">environment</span>
<span class="o">**</span> <span class="no">Execute</span> <span class="ss">db</span><span class="p">:</span><span class="n">abort_if_pending_migrations</span>
<span class="o">**</span> <span class="no">Execute</span> <span class="ss">db</span><span class="p">:</span><span class="nb">test</span><span class="ss">:prepare</span>
<span class="o">**</span> <span class="no">Invoke</span> <span class="ss">db</span><span class="p">:</span><span class="nb">test</span><span class="ss">:load</span> <span class="p">(</span><span class="n">first_time</span><span class="p">)</span>
<span class="o">**</span> <span class="no">Invoke</span> <span class="ss">db</span><span class="p">:</span><span class="nb">test</span><span class="ss">:purge</span> <span class="p">(</span><span class="n">first_time</span><span class="p">)</span>
<span class="o">**</span> <span class="no">Invoke</span> <span class="n">environment</span>
<span class="o">**</span> <span class="no">Execute</span> <span class="ss">db</span><span class="p">:</span><span class="nb">test</span><span class="ss">:purge</span>
<span class="o">**</span> <span class="no">Execute</span> <span class="ss">db</span><span class="p">:</span><span class="nb">test</span><span class="ss">:load</span>
<span class="o">**</span> <span class="no">Invoke</span> <span class="ss">db</span><span class="p">:</span><span class="ss">schema</span><span class="p">:</span><span class="nb">load</span> <span class="p">(</span><span class="n">first_time</span><span class="p">)</span>
<span class="o">**</span> <span class="no">Invoke</span> <span class="n">environment</span>
<span class="o">**</span> <span class="no">Execute</span> <span class="ss">db</span><span class="p">:</span><span class="ss">schema</span><span class="p">:</span><span class="nb">load</span>
<span class="o">**</span> <span class="no">Execute</span> <span class="n">spec</span></code></pre></div>

<ul>
  <li>
    <p>Don’t run the specs if there are pending migrations in the development database. (db:abort_if_pending_migrations)</p>
  </li>
  <li>
    <p>Drop the test database (db:test:purge)</p>
  </li>
  <li>
    <p>Load the schema into the test database (db:schema:load in environment “test”)</p>
  </li>
</ul>

  </article>

</div>


        <footer class="site-footer">
<a href="http://chengyuanheng.github.io/Jekyll/">blog</a> of <a href="https://github.com/chengyuanheng">cckkll</a>
</footer>


      </div>

    </body>
</html>
